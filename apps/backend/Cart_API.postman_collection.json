{
  "info": {
    "_postman_id": "cart-api-collection-001",
    "name": "Cart API",
    "description": "Complete collection for Cart management endpoints in Corner Coffee API",
    "schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json"
  },
  "auth": {
    "type": "bearer",
    "bearer": [
      {
        "key": "token",
        "value": "{{authToken}}",
        "type": "string"
      }
    ]
  },
  "variable": [
    {
      "key": "baseUrl",
      "value": "http://localhost:3000/api",
      "type": "string"
    },
    {
      "key": "authToken",
      "value": "",
      "type": "string"
    },
    {
      "key": "productId",
      "value": "",
      "type": "string"
    },
    {
      "key": "itemId",
      "value": "",
      "type": "string"
    },
    {
      "key": "addressId",
      "value": "",
      "type": "string"
    },
    {
      "key": "addOnId",
      "value": "",
      "type": "string"
    }
  ],
  "item": [
    {
      "name": "Get Cart",
      "event": [
        {
          "listen": "test",
          "script": {
            "exec": [
              "pm.test(\"Status code is 200\", function () {",
              "    pm.response.to.have.status(200);",
              "});",
              "",
              "pm.test(\"Response has success field\", function () {",
              "    var jsonData = pm.response.json();",
              "    pm.expect(jsonData).to.have.property('success');",
              "    pm.expect(jsonData.success).to.be.true;",
              "});",
              "",
              "pm.test(\"Response has cart data\", function () {",
              "    var jsonData = pm.response.json();",
              "    pm.expect(jsonData).to.have.property('data');",
              "});",
              "",
              "// Save first item ID if cart has items",
              "var jsonData = pm.response.json();",
              "if (jsonData.data && jsonData.data.items && jsonData.data.items.length > 0) {",
              "    pm.collectionVariables.set(\"itemId\", jsonData.data.items[0]._id);",
              "}"
            ],
            "type": "text/javascript"
          }
        }
      ],
      "request": {
        "method": "GET",
        "header": [],
        "url": {
          "raw": "{{baseUrl}}/cart",
          "host": ["{{baseUrl}}"],
          "path": ["cart"]
        },
        "description": "Retrieve the current user's cart with all items, totals, and delivery information."
      },
      "response": []
    },
    {
      "name": "Add Item to Cart",
      "event": [
        {
          "listen": "test",
          "script": {
            "exec": [
              "pm.test(\"Status code is 200\", function () {",
              "    pm.response.to.have.status(200);",
              "});",
              "",
              "pm.test(\"Response has success message\", function () {",
              "    var jsonData = pm.response.json();",
              "    pm.expect(jsonData.success).to.be.true;",
              "    pm.expect(jsonData.message).to.eql('Item added to cart');",
              "});",
              "",
              "// Save item ID from response",
              "var jsonData = pm.response.json();",
              "if (jsonData.data && jsonData.data.items && jsonData.data.items.length > 0) {",
              "    var lastItem = jsonData.data.items[jsonData.data.items.length - 1];",
              "    pm.collectionVariables.set(\"itemId\", lastItem._id);",
              "}"
            ],
            "type": "text/javascript"
          }
        }
      ],
      "request": {
        "method": "POST",
        "header": [
          {
            "key": "Content-Type",
            "value": "application/json"
          }
        ],
        "body": {
          "mode": "raw",
          "raw": "{\n  \"productId\": \"{{productId}}\",\n  \"quantity\": 2,\n  \"customization\": {\n    \"size\": \"large\",\n    \"sugar\": \"medium\",\n    \"ice\": \"less\"\n  },\n  \"addOns\": [\"{{addOnId}}\"],\n  \"notes\": \"Extra hot please\"\n}"
        },
        "url": {
          "raw": "{{baseUrl}}/cart/items",
          "host": ["{{baseUrl}}"],
          "path": ["cart", "items"]
        },
        "description": "Add a product to the cart with optional customization, add-ons, and notes."
      },
      "response": []
    },
    {
      "name": "Add Item (Minimal)",
      "event": [
        {
          "listen": "test",
          "script": {
            "exec": [
              "pm.test(\"Status code is 200\", function () {",
              "    pm.response.to.have.status(200);",
              "});",
              "",
              "pm.test(\"Item added successfully\", function () {",
              "    var jsonData = pm.response.json();",
              "    pm.expect(jsonData.success).to.be.true;",
              "});"
            ],
            "type": "text/javascript"
          }
        }
      ],
      "request": {
        "method": "POST",
        "header": [
          {
            "key": "Content-Type",
            "value": "application/json"
          }
        ],
        "body": {
          "mode": "raw",
          "raw": "{\n  \"productId\": \"{{productId}}\",\n  \"quantity\": 1\n}"
        },
        "url": {
          "raw": "{{baseUrl}}/cart/items",
          "host": ["{{baseUrl}}"],
          "path": ["cart", "items"]
        },
        "description": "Add a product to cart with only required fields (productId and quantity)."
      },
      "response": []
    },
    {
      "name": "Update Item Quantity",
      "event": [
        {
          "listen": "test",
          "script": {
            "exec": [
              "pm.test(\"Status code is 200\", function () {",
              "    pm.response.to.have.status(200);",
              "});",
              "",
              "pm.test(\"Item updated successfully\", function () {",
              "    var jsonData = pm.response.json();",
              "    pm.expect(jsonData.success).to.be.true;",
              "    pm.expect(jsonData.message).to.eql('Cart item updated');",
              "});"
            ],
            "type": "text/javascript"
          }
        }
      ],
      "request": {
        "method": "PATCH",
        "header": [
          {
            "key": "Content-Type",
            "value": "application/json"
          }
        ],
        "body": {
          "mode": "raw",
          "raw": "{\n  \"quantity\": 3\n}"
        },
        "url": {
          "raw": "{{baseUrl}}/cart/items/{{itemId}}",
          "host": ["{{baseUrl}}"],
          "path": ["cart", "items", "{{itemId}}"]
        },
        "description": "Update the quantity of a specific item in the cart."
      },
      "response": []
    },
    {
      "name": "Remove Item from Cart",
      "event": [
        {
          "listen": "test",
          "script": {
            "exec": [
              "pm.test(\"Status code is 200\", function () {",
              "    pm.response.to.have.status(200);",
              "});",
              "",
              "pm.test(\"Item removed successfully\", function () {",
              "    var jsonData = pm.response.json();",
              "    pm.expect(jsonData.success).to.be.true;",
              "    pm.expect(jsonData.message).to.eql('Item removed from cart');",
              "});"
            ],
            "type": "text/javascript"
          }
        }
      ],
      "request": {
        "method": "DELETE",
        "header": [],
        "url": {
          "raw": "{{baseUrl}}/cart/items/{{itemId}}",
          "host": ["{{baseUrl}}"],
          "path": ["cart", "items", "{{itemId}}"]
        },
        "description": "Remove a specific item from the cart."
      },
      "response": []
    },
    {
      "name": "Clear Cart",
      "event": [
        {
          "listen": "test",
          "script": {
            "exec": [
              "pm.test(\"Status code is 200\", function () {",
              "    pm.response.to.have.status(200);",
              "});",
              "",
              "pm.test(\"Cart cleared successfully\", function () {",
              "    var jsonData = pm.response.json();",
              "    pm.expect(jsonData.success).to.be.true;",
              "});"
            ],
            "type": "text/javascript"
          }
        }
      ],
      "request": {
        "method": "DELETE",
        "header": [],
        "url": {
          "raw": "{{baseUrl}}/cart",
          "host": ["{{baseUrl}}"],
          "path": ["cart"]
        },
        "description": "Remove all items from the cart."
      },
      "response": []
    },
    {
      "name": "Validate Cart",
      "event": [
        {
          "listen": "test",
          "script": {
            "exec": [
              "pm.test(\"Status code is 200\", function () {",
              "    pm.response.to.have.status(200);",
              "});",
              "",
              "pm.test(\"Validation response received\", function () {",
              "    var jsonData = pm.response.json();",
              "    pm.expect(jsonData.success).to.be.true;",
              "    pm.expect(jsonData.data).to.have.property('isValid');",
              "});"
            ],
            "type": "text/javascript"
          }
        }
      ],
      "request": {
        "method": "POST",
        "header": [],
        "url": {
          "raw": "{{baseUrl}}/cart/validate",
          "host": ["{{baseUrl}}"],
          "path": ["cart", "validate"]
        },
        "description": "Validate cart items for availability, pricing, and store status before checkout."
      },
      "response": []
    },
    {
      "name": "Set Delivery Address",
      "event": [
        {
          "listen": "test",
          "script": {
            "exec": [
              "pm.test(\"Status code is 200\", function () {",
              "    pm.response.to.have.status(200);",
              "});",
              "",
              "pm.test(\"Address updated successfully\", function () {",
              "    var jsonData = pm.response.json();",
              "    pm.expect(jsonData.success).to.be.true;",
              "    pm.expect(jsonData.message).to.eql('Delivery address updated');",
              "});"
            ],
            "type": "text/javascript"
          }
        }
      ],
      "request": {
        "method": "PATCH",
        "header": [
          {
            "key": "Content-Type",
            "value": "application/json"
          }
        ],
        "body": {
          "mode": "raw",
          "raw": "{\n  \"addressId\": \"{{addressId}}\"\n}"
        },
        "url": {
          "raw": "{{baseUrl}}/cart/address",
          "host": ["{{baseUrl}}"],
          "path": ["cart", "address"]
        },
        "description": "Set the delivery address for the cart."
      },
      "response": []
    },
    {
      "name": "Set Cart Notes",
      "event": [
        {
          "listen": "test",
          "script": {
            "exec": [
              "pm.test(\"Status code is 200\", function () {",
              "    pm.response.to.have.status(200);",
              "});",
              "",
              "pm.test(\"Notes updated successfully\", function () {",
              "    var jsonData = pm.response.json();",
              "    pm.expect(jsonData.success).to.be.true;",
              "    pm.expect(jsonData.message).to.eql('Cart notes updated');",
              "});"
            ],
            "type": "text/javascript"
          }
        }
      ],
      "request": {
        "method": "PATCH",
        "header": [
          {
            "key": "Content-Type",
            "value": "application/json"
          }
        ],
        "body": {
          "mode": "raw",
          "raw": "{\n  \"notes\": \"Please ring the doorbell twice\"\n}"
        },
        "url": {
          "raw": "{{baseUrl}}/cart/notes",
          "host": ["{{baseUrl}}"],
          "path": ["cart", "notes"]
        },
        "description": "Add or update general notes for the entire cart/order."
      },
      "response": []
    },
    {
      "name": "Clear Cart Notes",
      "event": [
        {
          "listen": "test",
          "script": {
            "exec": [
              "pm.test(\"Status code is 200\", function () {",
              "    pm.response.to.have.status(200);",
              "});",
              "",
              "pm.test(\"Notes cleared successfully\", function () {",
              "    var jsonData = pm.response.json();",
              "    pm.expect(jsonData.success).to.be.true;",
              "});"
            ],
            "type": "text/javascript"
          }
        }
      ],
      "request": {
        "method": "PATCH",
        "header": [
          {
            "key": "Content-Type",
            "value": "application/json"
          }
        ],
        "body": {
          "mode": "raw",
          "raw": "{\n  \"notes\": \"\"\n}"
        },
        "url": {
          "raw": "{{baseUrl}}/cart/notes",
          "host": ["{{baseUrl}}"],
          "path": ["cart", "notes"]
        },
        "description": "Clear cart notes by setting them to an empty string."
      },
      "response": []
    },
    {
      "name": "Get Cart Summary",
      "event": [
        {
          "listen": "test",
          "script": {
            "exec": [
              "pm.test(\"Status code is 200\", function () {",
              "    pm.response.to.have.status(200);",
              "});",
              "",
              "pm.test(\"Summary has required fields\", function () {",
              "    var jsonData = pm.response.json();",
              "    pm.expect(jsonData.success).to.be.true;",
              "    pm.expect(jsonData.data).to.have.property('itemCount');",
              "    pm.expect(jsonData.data).to.have.property('subtotal');",
              "    pm.expect(jsonData.data).to.have.property('total');",
              "});"
            ],
            "type": "text/javascript"
          }
        }
      ],
      "request": {
        "method": "GET",
        "header": [],
        "url": {
          "raw": "{{baseUrl}}/cart/summary",
          "host": ["{{baseUrl}}"],
          "path": ["cart", "summary"]
        },
        "description": "Get a quick summary of the cart including item count, subtotal, taxes, delivery charges, and total."
      },
      "response": []
    },
    {
      "name": "Error - Add Item Without Product ID",
      "event": [
        {
          "listen": "test",
          "script": {
            "exec": [
              "pm.test(\"Status code is 400\", function () {",
              "    pm.response.to.have.status(400);",
              "});",
              "",
              "pm.test(\"Error message returned\", function () {",
              "    var jsonData = pm.response.json();",
              "    pm.expect(jsonData.success).to.be.false;",
              "    pm.expect(jsonData.message).to.include('Product ID is required');",
              "});"
            ],
            "type": "text/javascript"
          }
        }
      ],
      "request": {
        "method": "POST",
        "header": [
          {
            "key": "Content-Type",
            "value": "application/json"
          }
        ],
        "body": {
          "mode": "raw",
          "raw": "{\n  \"quantity\": 1\n}"
        },
        "url": {
          "raw": "{{baseUrl}}/cart/items",
          "host": ["{{baseUrl}}"],
          "path": ["cart", "items"]
        },
        "description": "Test error handling when adding item without product ID."
      },
      "response": []
    },
    {
      "name": "Error - Invalid Quantity",
      "event": [
        {
          "listen": "test",
          "script": {
            "exec": [
              "pm.test(\"Status code is 400\", function () {",
              "    pm.response.to.have.status(400);",
              "});",
              "",
              "pm.test(\"Error message for invalid quantity\", function () {",
              "    var jsonData = pm.response.json();",
              "    pm.expect(jsonData.success).to.be.false;",
              "    pm.expect(jsonData.message).to.include('Quantity must be at least 1');",
              "});"
            ],
            "type": "text/javascript"
          }
        }
      ],
      "request": {
        "method": "POST",
        "header": [
          {
            "key": "Content-Type",
            "value": "application/json"
          }
        ],
        "body": {
          "mode": "raw",
          "raw": "{\n  \"productId\": \"{{productId}}\",\n  \"quantity\": 0\n}"
        },
        "url": {
          "raw": "{{baseUrl}}/cart/items",
          "host": ["{{baseUrl}}"],
          "path": ["cart", "items"]
        },
        "description": "Test error handling when quantity is less than 1."
      },
      "response": []
    },
    {
      "name": "Error - Invalid Item ID Format",
      "event": [
        {
          "listen": "test",
          "script": {
            "exec": [
              "pm.test(\"Status code is 400\", function () {",
              "    pm.response.to.have.status(400);",
              "});",
              "",
              "pm.test(\"Error message for invalid ID\", function () {",
              "    var jsonData = pm.response.json();",
              "    pm.expect(jsonData.success).to.be.false;",
              "    pm.expect(jsonData.message).to.include('Invalid item ID format');",
              "});"
            ],
            "type": "text/javascript"
          }
        }
      ],
      "request": {
        "method": "DELETE",
        "header": [],
        "url": {
          "raw": "{{baseUrl}}/cart/items/invalid-id-123",
          "host": ["{{baseUrl}}"],
          "path": ["cart", "items", "invalid-id-123"]
        },
        "description": "Test error handling when item ID format is invalid."
      },
      "response": []
    }
  ]
}
